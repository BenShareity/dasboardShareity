import{M as H,I as J}from"./ServerCall.bf212017.js";import{_ as X}from"./NavBar.1d7fa6fb.js";import{_ as Z}from"./CardBox.b1a10a53.js";import{L as ee}from"./LoadingSpinner.708020bb.js";import{_ as y}from"./BaseButton.060f3a5f.js";import{_ as te,U as ae,D as oe}from"./LayoutAuthenticated.ccaeb884.js";import{a as c,j as le,u as se,Q as ne,I as ce,x as ie,M as d,o as n,c as v,w as o,b as t,K as i,g as r,e as w,f as _,h as x,F as M,A as re,t as q,W as ue,S as de,U as ve}from"./index.8eef5a34.js";import{_ as me}from"./FormField.8a5b2723.js";import{_ as _e}from"./FormControl.b755056f.js";import{_ as pe}from"./CardBoxWidget.2a1575f3.js";import{A as C}from"./AgencyController.9cb3c224.js";import{_ as fe}from"./_plugin-vue_export-helper.cdc0426e.js";import"./alerts.ef7819ba.js";import"./session.f47d2680.js";import"./BaseIcon.86eb869a.js";import"./LoginController.5d91ed5e.js";import"./numeral.3c5f875f.js";import"./BaseLevel.c2afcd4c.js";import"./PillTag.2f043243.js";const V=A=>(de("data-v-98eecc5a"),A=A(),ve(),A),ge=V(()=>r("b",null,"Activate",-1)),he=V(()=>r("b",null,"Deactivate",-1)),ye=V(()=>r("b",null,"Approve",-1)),xe={class:"flex justify-between pb-5"},Ae={class:"flex gap-2 items-center"},ke=V(()=>r("p",{class:"lg:text-xl text-lg"},"Agencies",-1)),be={class:"flex gap-2 items-center edit-search"},we={key:0,class:"grid min-w-[50%] gap-6 mb-6"},Ce={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6"},Ve={class:"flex justify-between mb-2"},$e={class:"font-extrabold text-lg"},Ie={class:"grid grid-cols-3"},Se=["src"],De={class:"text-sm font-light col-span-2 line-clamp-4"},Be={key:0,class:"flex justify-center h-10"},Ue={key:1,class:"flex align-center justify-center h-screen"},je={__name:"AgenciesView",setup(A){const T="https://chgsdev.shareity.com/",s=c([]);c({});const u=c({}),p=c(!1),f=c(!1),m=c(Boolean),D=c();le(()=>P());const F=c(""),B=c({}),K=se(),k=c(18),$=c(0),g=c(""),I=c(!0);function P(){return s.value.filter(l=>{var e;(e=l.name)==null||e.includes(F.value),console.log(l.name)})}ne(async()=>{B.value=await ae.getMyProfile(),D.value=B.value.rol,m.value=!1});function Q(l){K.push({name:"create-agency",query:{id:l}})}async function W(){const l=u.value.id,e=await C.update(l,{status:!u.value.status});console.log(s);const h=s.value.indexOf(u.value);s.value[h].status=e.status,p.value=!1}async function R(){const l=await oe.updateAgency({id:u.value.id,adminApprove:1}),e=s.value.indexOf(u.value);s.value[e].adminApprove=l.adminApprove,f.value=!1}ce(g,async(l,e)=>{l?Y():U()});const Y=async()=>{g||console.log("se acabo la busqueda :>> "),s.value=[];let l={search:g.value,items:k.value};const e=await C.getData(l);s.value=e.page,I.value=!1},z=async()=>{if(I.value=!0,s.value.length>=18){$.value++;let l={page:$.value,items:k.value};console.log("pages.value :>> ",$.value),console.log("itemsScroll.value :>> ",k.value);try{await C.getAll(l).then(e=>{console.log("data :>> ",e),s.value=[...s.value,...e.page],console.log("causes.value :>> ",s.value)})}catch(e){console.log("error :>> ",e)}}},U=async()=>{m.value=!0,I.value=!0;let l={page:1,items:k.value};try{await C.getAll(l).then(e=>{s.value=e.page,console.log("estoy aqui",e),m.value=!1})}catch(e){console.log("error :>> ",e)}};return ie(()=>{U()}),(l,e)=>{const h=d("v-card-title"),S=d("v-card-text"),j=d("v-spacer"),b=d("v-btn"),L=d("v-card-actions"),N=d("v-card"),O=d("v-dialog"),G=d("CardBoxComponentTitle");return n(),v(te,null,{default:o(()=>[t(X,null,{default:o(()=>[t(O,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=a=>p.value=a),width:"auto"},{default:o(()=>[t(N,null,{default:o(()=>[u.value.status?(n(),v(h,{key:0,class:"text-h5"},{default:o(()=>[i(" Activate Agency? ")]),_:1})):(n(),v(h,{key:1,class:"text-h5"},{default:o(()=>[i(" Deactivate Agency? ")]),_:1})),u.value.status?(n(),v(S,{key:2},{default:o(()=>[i("Are you sure you want to "),ge,i(" this Agency?")]),_:1})):(n(),v(S,{key:3},{default:o(()=>[i("Are you sure you want to "),he,i(" this Agency?")]),_:1})),t(L,null,{default:o(()=>[t(j),t(b,{color:"red",variant:"text",onClick:e[0]||(e[0]=a=>p.value=!1)},{default:o(()=>[i(" Cancel ")]),_:1}),t(b,{color:"green-darken-1",variant:"text",onClick:e[1]||(e[1]=a=>W())},{default:o(()=>[i(" OK ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(O,{modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=a=>f.value=a),width:"auto"},{default:o(()=>[t(N,null,{default:o(()=>[t(h,{class:"text-h5"},{default:o(()=>[i(" Approve Agency? ")]),_:1}),t(S,null,{default:o(()=>[i("Are you sure you want to "),ye,i(" this Agency?")]),_:1}),t(L,null,{default:o(()=>[t(j),t(b,{color:"red",red:"",variant:"text",onClick:e[3]||(e[3]=a=>f.value=!1)},{default:o(()=>[i(" Cancel ")]),_:1}),t(b,{color:"green-darken-1",variant:"text",onClick:e[4]||(e[4]=a=>R())},{default:o(()=>[i(" Ok ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r("div",xe,[r("div",Ae,[t(y,{to:"/dashboard",icon:w(H),color:"info","rounded-full":"",small:""},null,8,["icon"]),ke]),r("div",be,[t(me,null,{default:o(()=>[t(_e,{modelValue:g.value,"onUpdate:modelValue":e[6]||(e[6]=a=>g.value=a),icon:l.mdiAccountBox,value:"Search"},null,8,["modelValue","icon"])]),_:1}),t(y,{class:"mr-5",label:"Add Agencies",color:"info",icon:w(J),to:"/create-agency"},null,8,["icon"])])]),!m.value&&s.value.length==0?(n(),_("div",we,[t(pe,{icon:l.mdiCartOutline,label:"It seems that there are no agency related to you yet :(",content:'You can create a agency by clicking on the "+ Add Agencies" button!!'},null,8,["icon"])])):x("",!0),!m.value&&s.value.length>0?(n(),_("div",Ce,[(n(!0),_(M,null,re(s.value,a=>(n(),v(Z,{class:"max-h-52",key:a.id},{default:o(()=>[t(G,{title:"With title & icon"},{default:o(()=>[r("div",Ve,[r("p",$e,q(a.name),1)])]),_:2},1024),r("div",Ie,[r("img",{class:"col-span-1 mr-3",src:w(T)+a.img,style:{height:"64px",width:"64px"}},null,8,Se),r("p",De,q(a.description),1)]),D.value==="admin"?(n(),_(M,{key:0},[a.adminApprove==!0?(n(),v(y,{key:0,class:"mt-3 text-lg font-bold italic mr-2",small:"",label:a.status?"Activate":"deactivate",Activar:"",color:a.status?"success":"danger",onClick:E=>{p.value=!0,u.value=a}},null,8,["label","color","onClick"])):(n(),v(y,{key:1,class:"mt-3 text-lg font-bold italic mr-2",small:"",label:"Approve",color:"info",onClick:E=>{f.value=!0,u.value=a}},null,8,["onClick"])),t(y,{class:"mt-3 text-lg font-bold italic",small:"",label:"Edit",color:"info",onClick:E=>Q(a.id)},null,8,["onClick"])],64)):x("",!0)]),_:2},1024))),128))])):x("",!0)]),_:1}),m.value?x("",!0):(n(),_("div",Be,[t(w(ue),{onInfinite:e[7]||(e[7]=a=>z())})])),m.value?(n(),_("div",Ue,[t(ee)])):x("",!0)]),_:1})}}},Ze=fe(je,[["__scopeId","data-v-98eecc5a"]]);export{Ze as default};
