import{a as o,j as ne,Q as ie,P as re,u as ue,x as ce,M as g,o as a,c as d,w as s,b as n,K as c,g as r,e as S,f as u,q as U,z as de,h as m,F as O,A as F,t as b,O as j,n as ve,S as me,U as pe}from"./index.8eef5a34.js";import{M as _e,I as K}from"./ServerCall.bf212017.js";import{_ as fe}from"./NavBar.1d7fa6fb.js";import{_ as ge}from"./CardBox.b1a10a53.js";import{L as he}from"./LoadingSpinner.708020bb.js";import{_ as h}from"./BaseButton.060f3a5f.js";import{_ as xe,U as Q,D as be}from"./LayoutAuthenticated.ccaeb884.js";import{O as W}from"./OrganizationController.a9249f99.js";import{u as ye}from"./session.f47d2680.js";import{_ as ke}from"./FormField.8a5b2723.js";import{_ as Ce}from"./FormControl.b755056f.js";import{_ as Ae}from"./CardBoxWidget.2a1575f3.js";import{u as we}from"./alerts.ef7819ba.js";import{_ as Se}from"./_plugin-vue_export-helper.cdc0426e.js";import"./BaseIcon.86eb869a.js";import"./LoginController.5d91ed5e.js";import"./numeral.3c5f875f.js";import"./BaseLevel.c2afcd4c.js";import"./PillTag.2f043243.js";const y=$=>(me("data-v-52d39c9c"),$=$(),pe(),$),$e=y(()=>r("b",null,"Activate",-1)),Ve=y(()=>r("b",null,"Deactivate",-1)),De=y(()=>r("b",null,"Approve",-1)),Ue={class:"flex justify-between pb-5"},Ie={class:"flex gap-2 items-center"},Be=y(()=>r("p",{class:"lg:text-xl text-lg"},"Causes",-1)),Oe={key:0,class:"flex items-center justify-center gap-2"},je=["value"],Ee={key:0,class:"flex gap-[6px] items-center justify-center"},Ne=y(()=>r("label",{for:"check",class:"bg-red-400/90 text-center text-white shadow-lg font-medium rounded-lg w-6 hover:bg-red-500 cursor-pointer"},"X",-1)),ze={key:0,class:"text-gray-400 text-sm"},Le={class:"flex gap-2 items-center edit-search"},Me={key:0,class:"grid min-w-[50%] gap-6 mb-6"},Pe={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6"},Te={key:0,class:"flex justify-between mb-2"},qe={class:"font-extrabold text-lg"},Re={class:"flex items-center flex-col"},Fe=y(()=>r("h2",{class:"text-xs text-gray-700"},"Status",-1)),Ke=["textContent"],Qe={class:"grid grid-cols-3"},We=["src"],Xe=["src"],Ye={class:"text-sm font-light col-span-2 line-clamp-4"},Ge={key:0,class:"flex align-center justify-center h-screen"},He="organization/default.png",Je={__name:"CausesView",setup($){const E="https://chgsdev.shareity.com/",X=ye(),_=o([]),p=o({}),f=o(null),k=o(!1),C=o(!1),V=o(!1);o(!1);const v=o();o(18),o(0),o(!0);const Y=ne(()=>Z());o([]),o("");const N=o("");o(""),o("");const G=we(),A=o({}),H=o([{label:"Active"},{label:"Inactive"},{label:"Unregisterd"},{label:"Unapproved"}]);o(!1);const I=o(null),i=o({label:[]}),J=o({0:"Inactive",1:"Active",5:"Unregisterd",3:"Not validated",undefined:"Invalid"});function Z(){return _.value.filter(t=>(i==null?void 0:i.value.label.length)===0?!0:i==null?void 0:i.value.label.includes(z(t)))}function z(t){return t.status==5&&!t.adminApprove?"Unapproved":J.value[t.status]||t.status}ie(async()=>{if(A.value=await Q.getMyProfile(),console.log(A.value),v.value=A.value.rol,A.value.rol==="sponsor"){console.log("este",v.value),await Q.adminApprove().then(t=>{}).catch(t=>{I.value=t.response.data.message});return}});function L(t){if(t=="Deselect All")i.value.label=[],f.value=null;else if(i.value.label.includes(t)){const l=i.value.label.indexOf(t);i.value.label.splice(l,1),f.value=i.value.label.slice(0,1).toString(),console.log(f.value),i.value.label.length||(f.value=null,console.log("hoa"))}else i.value.label.push(t)}function ee(){G.createAlert({title:"It has not yet been approved",color:"error",icon:"$warning",text:I.value})}re(async()=>{v.value=X.getUserRole()});const te=ue();function M(t){te.push({name:"create-cause",query:{id:t}})}async function le(){const t=p.value.id,l=await W.update(t,{status:!p.value.status}),w=_.value.indexOf(p.value);_.value[w].status=l.status,k.value=!1}async function ae(){const t=await be.updateOrganization({id:p.value.id,adminApprove:1});console.log(t);const l=_.value.indexOf(p.value);_.value[l].adminApprove=t.adminApprove,C.value=!1}const oe=async()=>{try{await W.getDashboard().then(t=>{_.value=t,V.value=!1})}catch(t){console.log("error :>> ",t)}};return ce(()=>{oe()}),(t,l)=>{const w=g("v-card-title"),B=g("v-card-text"),P=g("v-spacer"),D=g("v-btn"),T=g("v-card-actions"),q=g("v-card"),R=g("v-dialog"),se=g("CardBoxComponentTitle");return a(),d(xe,null,{default:s(()=>[n(fe,null,{default:s(()=>[n(R,{modelValue:k.value,"onUpdate:modelValue":l[2]||(l[2]=e=>k.value=e),width:"auto"},{default:s(()=>[n(q,null,{default:s(()=>[p.value.status?(a(),d(w,{key:0,class:"text-h5"},{default:s(()=>[c(" Activate Cause? ")]),_:1})):(a(),d(w,{key:1,class:"text-h5"},{default:s(()=>[c(" Deactivate Cause? ")]),_:1})),p.value.status?(a(),d(B,{key:2},{default:s(()=>[c("Are you sure you want to "),$e,c(" this cause?")]),_:1})):(a(),d(B,{key:3},{default:s(()=>[c("Are you sure you want to "),Ve,c(" this cause?")]),_:1})),n(T,null,{default:s(()=>[n(P),n(D,{color:"red",variant:"text",onClick:l[0]||(l[0]=e=>k.value=!1)},{default:s(()=>[c(" Disagree ")]),_:1}),n(D,{color:"green-darken-1",variant:"text",onClick:l[1]||(l[1]=e=>le())},{default:s(()=>[c(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(R,{modelValue:C.value,"onUpdate:modelValue":l[5]||(l[5]=e=>C.value=e),width:"auto"},{default:s(()=>[n(q,null,{default:s(()=>[n(w,{class:"text-h5"},{default:s(()=>[c("Approve Cause? ")]),_:1}),n(B,null,{default:s(()=>[c("Are you sure you want to "),De,c(" this cause?")]),_:1}),n(T,null,{default:s(()=>[n(P),n(D,{color:"red",variant:"text",onClick:l[3]||(l[3]=e=>C.value=!1)},{default:s(()=>[c(" Disagree ")]),_:1}),n(D,{color:"green-darken-1",variant:"text",onClick:l[4]||(l[4]=e=>ae())},{default:s(()=>[c(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r("div",Ue,[r("div",Ie,[n(h,{to:"/dashboard",icon:S(_e),color:"info","rounded-full":"",small:""},null,8,["icon"]),Be,A.value.rol==="admin"?(a(),u("div",Oe,[U(r("select",{id:"",class:"shadow-lg rounded-lg","onUpdate:modelValue":l[6]||(l[6]=e=>f.value=e),onChange:l[7]||(l[7]=e=>L(f.value))},[f.value?m("",!0):(a(),u("option",{key:0,value:null}," Select Status ",8,je)),(a(!0),u(O,null,F(H.value,e=>{var x;return a(),u("option",{class:ve((x=i.value)!=null&&x.label.includes(e.label)?"bg-gray-200/90":"")},b(e.label),3)}),256))],544),[[de,f.value]]),i.value.label.length>0?(a(),u("div",Ee,[r("input",{class:"hidden shadow-lg p-2 rounded cursor-pointer hover: border border-sky-700",type:"checkbox",name:"check",id:"check",onChange:l[8]||(l[8]=e=>L("Deselect All"))},null,32),Ne,r("span",null,b(i.value.label.slice(0,2).join(" ").toString()),1),i.value.label.length>2?(a(),u("span",ze," (+"+b(i.value.label.length-2)+" others) ",1)):m("",!0)])):m("",!0)])):m("",!0)]),r("div",Le,[n(ke,null,{default:s(()=>[n(Ce,{modelValue:N.value,"onUpdate:modelValue":l[9]||(l[9]=e=>N.value=e),icon:t.mdiAccountBox,value:"Search"},null,8,["modelValue","icon"])]),_:1}),I.value?U((a(),d(h,{key:0,onClick:ee,class:"mr-5",label:"Add Cause",color:"info",icon:S(K)},null,8,["icon"])),[[j,v.value==="sponsor"||v.value==="admin"]]):U((a(),d(h,{key:1,class:"mr-5",label:"Add Cause",color:"info",icon:S(K),to:"/create-cause"},null,8,["icon"])),[[j,v.value==="sponsor"||v.value==="admin"]])])]),!V.value&&_.value.length==0?(a(),u("div",Me,[n(Ae,{icon:t.mdiCartOutline,label:"It seems that there are no Causes related to you yet :(",content:'You can connect a Cause by clicking on the "+ Add cause" button'},null,8,["icon"])])):m("",!0),!V.value&&_.value.length>0?(a(),u("div",Pe,[(a(!0),u(O,null,F(Y.value,e=>(a(),d(ge,{class:"max-h-52",key:e.id},{default:s(()=>[n(se,{title:"With title & icon"},{default:s(()=>[e.name?(a(),u("div",Te,[r("p",qe,b(e.name),1),r("div",Re,[Fe,r("p",{class:"text-xs text-gray-500",textContent:b(z(e))},null,8,Ke)])])):m("",!0)]),_:2},1024),r("div",Qe,[e.logo?(a(),u("img",{key:1,class:"col-span-1 mr-3",src:S(E)+e.logo,style:{height:"64px",width:"64px"}},null,8,Xe)):(a(),u("img",{key:0,class:"col-span-1 mr-3",src:S(E)+He,style:{height:"64px",width:"64px"}},null,8,We)),r("p",Ye,b(e.description),1)]),v.value==="admin"?(a(),u(O,{key:0},[e.adminApprove==!0?U((a(),d(h,{key:0,class:"mt-3 text-lg font-bold italic mr-2",small:"",label:e.status?"Deactivate":"Activate",color:e.status?"danger":"success",onClick:x=>{k.value=!0,p.value=e}},null,8,["label","color","onClick"])),[[j,v.value==="admin"]]):(a(),d(h,{key:1,class:"mt-3 text-lg font-bold italic mr-2",small:"",label:"Approve",color:"info",onClick:x=>{C.value=!0,p.value=e}},null,8,["onClick"]))],64)):m("",!0),v.value==="admin"?(a(),d(h,{key:1,class:"mt-3 text-lg font-bold italic",small:"",label:"Edit",color:"info",onClick:x=>M(e.id)},null,8,["onClick"])):m("",!0),v.value==="cause"&&(e==null?void 0:e.status)!=1?(a(),d(h,{key:2,class:"mt-3 text-lg font-bold italic",small:"",label:"Edit",color:"info",onClick:x=>M(e.id)},null,8,["onClick"])):m("",!0)]),_:2},1024))),128))])):m("",!0)]),_:1}),V.value?(a(),u("div",Ge,[n(he)])):m("",!0)]),_:1})}}},ht=Se(Je,[["__scopeId","data-v-52d39c9c"]]);export{ht as default};
