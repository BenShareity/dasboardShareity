import{u as q,a as o,H as R,r as B,I as k,x as M,o as s,c as l,w as i,b,n as D,d as I,g as y,q as N,B as T,e as W,f as L,t as O,h as _}from"./index.8eef5a34.js";import{_ as P}from"./shareity-logo.5aa589ac.js";import{S as U,u as j,m as z}from"./ServerCall.bf212017.js";import{_ as H,a as F}from"./LayoutGuest.a706e16b.js";import{_ as G}from"./CardBox.b1a10a53.js";import{_ as J}from"./FormField.8a5b2723.js";import{_ as w}from"./BaseButton.060f3a5f.js";import{_ as K}from"./BaseButtons.7d99a140.js";import{_ as x}from"./CardBoxWidget.2a1575f3.js";import{r as p}from"./regex.a06b4297.js";import{R as Q}from"./RegisterConstroller.4a580cee.js";import{u as X}from"./alerts.ef7819ba.js";import"./BaseIcon.86eb869a.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./numeral.3c5f875f.js";import"./BaseLevel.c2afcd4c.js";import"./PillTag.2f043243.js";const E={sendEmail:async m=>{console.log("sendEmail :>> ",m);try{return(await U.post("/auth/send-email-validation",{email:m.email})).data}catch(n){throw console.log(n),n.response.data}}};const Y={class:"flex flex-col items-center"},Z=y("img",{class:"w-2/3",src:P,alt:"Shareity Logo"},null,-1),ee=["icon"],te={key:0,class:"text-red text-sm font-medium uppercase pt-2"},he={__name:"email-validation",setup(m){const{cookies:n}=j(),f=X(),v=q(),V=o(),$=o(),c=o(!1),d=R(),r=o(null),g=o(!1),h=o(null),t=B({email:""}),C=async()=>{try{await Q.authProfile()&&(c.value=!0)}catch(e){e.response.data.statusCode==401&&(c.value=!1)}};k(()=>t.email,()=>{t.email?p.test(t.email.trim())?r.value=null:r.value="Invalid email":r.value="Required field"}),k(()=>{g.value=!p.test(t.email.trim())}),M(()=>{var e,a,u;(e=d.query)!=null&&e.token&&(h.value=(a=d.query)==null?void 0:a.token,n.set("accessToken",(u=d.query)==null?void 0:u.token),h.value&&(v.replace({query:""}),C()))});const S=async()=>{t.email?p.test(t.email.trim())||(r.value="Invalid email"):r.value="Required field",console.log("entro"),E.sendEmail(t).then(async e=>{if(console.log("register :>> ",e),e)try{await E.sendEmail(t)&&f.createAlert({title:"User successfully registered! ",icon:"$success",text:"the user has been created successfully!"})}catch(a){console.log("error :>> ",a),f.createAlert({title:"an error has occurred try later! ",icon:"$error",text:"the user has been created successfully!"})}v.push("/MessageRegister")}).catch(e=>{console.log("exploto",inValid.value),e.error&&(inValid.value=!0,console.log("akgo"),V.value="An error occurred while registering the user"),f.createAlert({title:`An error occurred while registering the user ${e.error}`,icon:"$danger",text:e.message,color:"red-accent-4"})})};return(e,a)=>(s(),l(H,null,{default:i(()=>[b(F,{bg:"blueWhite"},{default:i(({cardClass:u})=>[t.setPass?_("",!0):(s(),l(G,{key:0,class:D(`${u} my-8`),"is-form":"",onSubmit:I(S,["prevent"])},{footer:i(()=>[b(K,{type:"flex-col justify-center items-center"},{default:i(()=>[c.value?(s(),l(w,{key:0,to:"/",color:"info",class:"sm:w-1/2 w-full",label:"Login"})):(s(),l(w,{key:1,type:"submit",color:"info",class:"sm:w-1/2 w-full",label:"Send Email Again",disabled:g.value},null,8,["disabled"]))]),_:1})]),default:i(()=>[y("div",Y,[Z,c.value?(s(),l(x,{key:0,icon:e.mdiCartOutline,label:"Verified  Account",content:"We have successfully validated your email, please login",class:"text-center"},null,8,["icon"])):(s(),l(x,{key:1,icon:e.mdiCartOutline,label:"Verification error",content:"We could not validate your email, enter your email again",class:"text-center mb-25"},null,8,["icon"]))]),c.value?_("",!0):(s(),l(J,{key:0,label:"Email",class:"form_style"},{default:i(()=>[N(y("input",{"onUpdate:modelValue":a[0]||(a[0]=A=>t.email=A),icon:W(z),name:"email",autocomplete:"current-password",class:"border rounded-md h-[48px] w-full",ref_key:"refEmail",ref:$},null,8,ee),[[T,t.email]]),r.value?(s(),L("p",te,O(r.value),1)):_("",!0)]),_:1}))]),_:2},1032,["class"]))]),_:1})]),_:1}))}};export{he as default};
