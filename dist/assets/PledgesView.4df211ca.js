import{a as n,j as nt,Q as rt,M as v,o as i,c as b,w as a,b as o,g as s,e as Z,K as r,t as h,f as d,F,A as q,h as k,q as K,O as Q}from"./index.8eef5a34.js";import{S as z,M as it}from"./ServerCall.bf212017.js";import{_ as ct}from"./NavBar.1d7fa6fb.js";import{_ as ut}from"./CardBox.b1a10a53.js";import{_ as dt,U as vt}from"./LayoutAuthenticated.ccaeb884.js";import{L as _t}from"./LoadingSpinner.708020bb.js";import{_ as H}from"./BaseButton.060f3a5f.js";import{u as mt}from"./session.f47d2680.js";import"./alerts.ef7819ba.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./BaseIcon.86eb869a.js";import"./LoginController.5d91ed5e.js";const O={getAll:async()=>{try{return(await z.get("/pledges/list")).data}catch(x){throw x}},approvePledges:async x=>{try{return(await z.post("/pledges/approveDeny",x)).data}catch(g){throw g}}};const ft={class:"flex justify-between pb-5"},ht={class:"flex gap-2 items-center"},pt=s("p",{class:"font-extrabold"},"Pledges",-1),xt={key:0,class:"p-3 bg-gray-100/50 dark:bg-slate-800"},wt={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},yt={key:0,class:"flex align-center justify-center h-screen"},kt={key:1,class:"table-auto w-full text-sm text-left text-gray-500 dark:text-gray-400"},gt={class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},Ct=s("th",{scope:"col",class:"w-12 px-6 py-3"},"Profile Picture",-1),At={scope:"col",class:"px-6 py-3"},Dt={class:"flex items-center"},bt=s("svg",{class:"w-3 h-3 ml-1.5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24"},[s("path",{d:"M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"})],-1),Pt=[bt],Vt={scope:"col",class:"px-6 py-3"},$t={class:"flex items-center"},St=s("svg",{class:"w-3 h-3 ml-1.5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24"},[s("path",{d:"M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"})],-1),Bt=[St],Nt={scope:"col",class:"w-20 px-6 py-3"},Lt={class:"flex items-center"},Ut=s("svg",{class:"w-3 h-3 ml-1.5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24"},[s("path",{d:"M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"})],-1),jt=[Ut],Mt={scope:"col",class:"col-auto px-6 py-3"},Zt={class:"flex items-center"},Ht=s("svg",{class:"w-3 h-3 ml-1.5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24"},[s("path",{d:"M8.574 11.024h6.852a2.075 2.075 0 0 0 1.847-1.086 1.9 1.9 0 0 0-.11-1.986L13.736 2.9a2.122 2.122 0 0 0-3.472 0L6.837 7.952a1.9 1.9 0 0 0-.11 1.986 2.074 2.074 0 0 0 1.847 1.086Zm6.852 1.952H8.574a2.072 2.072 0 0 0-1.847 1.087 1.9 1.9 0 0 0 .11 1.985l3.426 5.05a2.123 2.123 0 0 0 3.472 0l3.427-5.05a1.9 1.9 0 0 0 .11-1.985 2.074 2.074 0 0 0-1.846-1.087Z"})],-1),Ot=[Ht],Et={key:1,scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},Rt=["src"],Tt={key:2,scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},It=["src"],Ft={class:"px-6 py-4"},qt={class:"px-6 py-4"},Kt={class:"px-6 py-4"},Qt={class:"before:hidden lg:w-1 whitespace-nowrap"},zt={key:2},Gt={key:0,class:"text-red-600"},Jt={key:1,class:"text-green-600"},Wt={class:"text-center"},Xt=s("p",{class:"text-lg italic font-bold"},[r("User has been "),s("b",null,"Deleted")],-1),Yt=!1,te="../../assets/user.png",_e={__name:"PledgesView",setup(x){const g=mt(),m=n([]),P=n({}),G="https://chgsdev.shareity.com/",V=n(!1);n(0);const E=n([]),u=n({field:"firstName",order:1}),$=n(!1),w=n(!1),y=n(!1);n([]);const C=n(10),S=n(1),R=n(0),B=n({});n(1),n(0);const _=n({});n(null);const A=n(Boolean),J=nt(()=>{const l=(S.value-1)*C.value;return m.value.sort((e,c)=>{var p;if(((p=u==null?void 0:u.value)==null?void 0:p.field)==="status")return console.log(e),console.log("Holaa"),((e==null?void 0:e.isActDonat)>(c==null?void 0:c.isActDonat)?1:-1)*u.value.order;if(u.value.field==="description")return((e==null?void 0:e.description)&&(e==null?void 0:e.isActDonat)>(c==null?void 0:c.isActDonat)?1:-1)*u.value.order;if(u.value.field==="amount")return((e==null?void 0:e.amount)<(c==null?void 0:c.amount)?1:-1)*u.value.order}).slice(l,l+C.value)}),W="https://chgsdev.shareity.com/";rt(async()=>{P.value=await vt.getMyProfile(),A.value=!0,O.getAll(g.getUserId()).then(l=>{m.value=l,A.value=!1,console.log(m.value),R.value=Math.ceil(l.length/C.value)})});function D(l){console.log(l),u.value.field===l?(console.log("campo",l),u.value.order*=-1):(u.value.field=l,u.value.order=1)}const T=l=>{if(console.log(l),l.isActDonat===1)return y.value=!0,_.value=l;if(l.isActDonat===0||l.isActDonat===null)return w.value=!0,_.value=l},X=async()=>{console.log(_);const l=await O.approvePledges({idPledge:_.value.id,status:!_.value.isActDonat});let e=m.value.indexOf(_.value);m.value[e].isActDonat=l.isActDonat,w.value=!1},Y=async()=>{const l=await O.approvePledges({idPledge:_.value.id,status:!_.value.isActDonat});let e=m.value.indexOf(_.value);m.value[e].isActDonat=l.isActDonat,y.value=!1};async function tt(){}return(l,e)=>{const c=v("v-card-title"),p=v("v-card-text"),N=v("v-spacer"),f=v("v-btn"),L=v("v-card-actions"),U=v("v-card"),j=v("v-dialog"),et=v("TableCheckboxCell"),st=v("BaseButtons"),ot=v("v-pagination"),at=v("v-snackbar");return i(),b(dt,null,{default:a(()=>[o(ct,null,{default:a(()=>[s("div",ft,[s("div",ht,[o(H,{to:"/dashboard",icon:Z(it),color:"info","rounded-full":"",small:""},null,8,["icon"]),pt])]),o(ut,{class:"mb-6 m","has-table":""},{default:a(()=>[s("div",null,[o(j,{modelValue:$.value,"onUpdate:modelValue":e[2]||(e[2]=t=>$.value=t),width:"auto"},{default:a(()=>[o(U,null,{default:a(()=>[o(c,{class:"text-h5"},{default:a(()=>[r(" Accept "+h(B.value.firstName)+" donation ",1)]),_:1}),o(p,null,{default:a(()=>[r("Surely do you want to accept this donation?")]),_:1}),o(L,null,{default:a(()=>[o(N),o(f,{color:"green-darken-1",variant:"text",onClick:e[0]||(e[0]=t=>$.value=!1)},{default:a(()=>[r(" Disagree ")]),_:1}),o(f,{color:"red",variant:"text",onClick:e[1]||(e[1]=t=>tt())},{default:a(()=>[r(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(j,{modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=t=>w.value=t),width:"auto"},{default:a(()=>[o(U,null,{default:a(()=>[o(c,{class:"text-h5"},{default:a(()=>[r(" Active "+h(B.value.firstName)+" donation ",1)]),_:1}),o(p,null,{default:a(()=>[r("Surely do you want to reject this donation?")]),_:1}),o(L,null,{default:a(()=>[o(N),o(f,{color:"red",variant:"text",onClick:e[3]||(e[3]=t=>w.value=!1)},{default:a(()=>[r(" Close ")]),_:1}),o(f,{color:"green-darken-1",s:"",variant:"text",onClick:e[4]||(e[4]=t=>X())},{default:a(()=>[r(" APPROVE ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(j,{modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=t=>y.value=t),width:"auto"},{default:a(()=>[o(U,null,{default:a(()=>[o(c,{class:"text-h5"},{default:a(()=>[r(" Desactive "+h(B.value.firstName)+" donation ",1)]),_:1}),o(p,null,{default:a(()=>[r("Surely do you want to reject this donation?")]),_:1}),o(L,null,{default:a(()=>[o(N),o(f,{color:"green-darken-1",variant:"text",onClick:e[6]||(e[6]=t=>y.value=!1)},{default:a(()=>[r(" Approve ")]),_:1}),o(f,{color:"red",variant:"text",onClick:e[7]||(e[7]=t=>Y())},{default:a(()=>[r(" Deny ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),E.value.length?(i(),d("div",xt,[(i(!0),d(F,null,q(E.value,t=>(i(),d("span",{key:t.id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm bg-gray-100 dark:bg-slate-700"},h(t.name),1))),128))])):k("",!0),s("div",wt,[A.value?(i(),d("div",yt,[o(_t)])):k("",!0),A.value?k("",!0):(i(),d("table",kt,[s("thead",gt,[s("tr",null,[Ct,s("th",At,[s("div",Dt,[r(" Name "),s("a",{onClick:e[9]||(e[9]=t=>D("firstName"))},Pt)])]),s("th",Vt,[s("div",$t,[r(" DESCRIPTION "),s("a",{onClick:e[10]||(e[10]=t=>D("description"))},Bt)])]),s("th",Nt,[s("div",Lt,[r(" Amont "),s("a",{onClick:e[11]||(e[11]=t=>D("amount"))},jt)])]),s("th",Mt,[s("div",Zt,[r(" Status "),s("a",{onClick:e[12]||(e[12]=t=>D("status"))},Ot)])])])]),s("tbody",null,[(i(!0),d(F,null,q(J.value,(t,lt)=>{var I;return i(),d("tr",{key:lt,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700"},[Yt?(i(),b(et,{key:0,onChecked:M=>l.checked(M,t)},null,8,["onChecked"])):k("",!0),(t==null?void 0:t.image)&&(t==null?void 0:t.imagen.match(/.*\..{2,5}/))?(i(),d("th",Et,[s("img",{class:"rounded-full",src:Z(G)+(t==null?void 0:t.imagen),alt:""},null,8,Rt)])):(i(),d("th",Tt,[s("img",{src:`${(t==null?void 0:t.imagen)!=null?Z(W)+(t==null?void 0:t.imagen):te}`,class:"rounded-full w-12 h-12"},null,8,It)])),s("td",Ft,h(`${(I=t==null?void 0:t.user)==null?void 0:I.firstName} ${(t==null?void 0:t.lastName)||""}`),1),s("td",qt,h(t==null?void 0:t.description),1),s("td",Kt,h(t==null?void 0:t.amount),1),s("td",Qt,[o(st,{type:"justify-start lg:justify-end","no-wrap":""},{default:a(()=>[P.value.rol!="admin"?K((i(),b(H,{key:0,color:"success",label:"Acepted",small:"",onClick:M=>T(t)},null,8,["onClick"])),[[Q,t.isActDonat===0||t.isActDonat===null]]):k("",!0),P.value.rol!="admin"?K((i(),b(H,{key:1,color:"danger",label:"Unapcepted",small:"",onClick:M=>T(t)},null,8,["onClick"])),[[Q,t.isActDonat===1]]):(i(),d("div",zt,[(t==null?void 0:t.isActDonat)===0||(t==null?void 0:t.isActDonat)===null?(i(),d("p",Gt," Unapcepted ")):(i(),d("p",Jt,"Acepted"))]))]),_:2},1024)])])}),128))])]))]),s("div",Wt,[o(ot,{modelValue:S.value,"onUpdate:modelValue":e[13]||(e[13]=t=>S.value=t),length:R.value,"total-visible":C.value},null,8,["modelValue","length","total-visible"])])])]),_:1})]),_:1}),o(at,{modelValue:V.value,"onUpdate:modelValue":e[15]||(e[15]=t=>V.value=t),timeout:3e3,color:"red"},{actions:a(()=>[o(f,{color:"white",variant:"text",onClick:e[14]||(e[14]=t=>V.value=!1)},{default:a(()=>[r(" Close ")]),_:1})]),default:a(()=>[Xt]),_:1},8,["modelValue"])]),_:1})}}};export{_e as default};
