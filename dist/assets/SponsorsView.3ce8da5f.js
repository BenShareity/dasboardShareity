import{a as i,u as se,j as ne,Q as re,x as ie,M as g,o,c as d,w as a,b as s,K as u,g as r,e as S,f as c,q as I,z as ce,h as v,F as B,A as K,t as w,O as N,n as ue,S as de,U as ve}from"./index.8eef5a34.js";import{M as pe,I as Q}from"./ServerCall.bf212017.js";import{_ as me}from"./NavBar.1d7fa6fb.js";import{_ as _e}from"./CardBox.b1a10a53.js";import{_ as h}from"./BaseButton.060f3a5f.js";import{_ as fe,U as R,D as ge}from"./LayoutAuthenticated.ccaeb884.js";import{S as W}from"./SponsorController.56304a20.js";import{_ as he}from"./FormField.8a5b2723.js";import{_ as xe}from"./FormControl.b755056f.js";import{L as be}from"./LoadingSpinner.708020bb.js";import{_ as ye}from"./CardBoxWidget.2a1575f3.js";import{u as ke}from"./alerts.ef7819ba.js";import{_ as Ae}from"./_plugin-vue_export-helper.cdc0426e.js";import"./session.f47d2680.js";import"./BaseIcon.86eb869a.js";import"./LoginController.5d91ed5e.js";import"./numeral.3c5f875f.js";import"./BaseLevel.c2afcd4c.js";import"./PillTag.2f043243.js";const b=C=>(de("data-v-c1f4339d"),C=C(),ve(),C),Se=b(()=>r("b",null,"Activate",-1)),we=b(()=>r("b",null,"Deactivate",-1)),Ce=b(()=>r("b",null,"Approve",-1)),$e={class:"flex justify-between pb-5"},Ve={class:"flex gap-2 items-center"},De=b(()=>r("p",{class:"lg:text-xl text-lg"},"Sponsors",-1)),Ie={key:0,class:"flex items-center justify-center gap-2"},Ue=["value"],je={key:0,class:"flex gap-[6px] items-center justify-center"},Ee=b(()=>r("label",{for:"check",class:"bg-red-400/90 text-center text-white shadow-lg font-medium rounded-lg w-6 hover:bg-red-500 cursor-pointer"},"X",-1)),Be={key:0,class:"text-gray-400 text-sm"},Ne={class:"flex gap-2 items-center edit-search"},Le={key:0,class:"grid min-w-[50%] gap-6 mb-6"},Me={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6"},Oe={class:"flex justify-between mb-2"},Te={class:"font-extrabold text-lg"},qe={class:"flex items-center flex-col"},ze=b(()=>r("h2",{class:"text-xs text-gray-700"},"Status",-1)),Pe=["textContent"],Fe={key:0,class:"text-[11px] text-gray-500"},Ke={key:0,class:"flex grid-cols-3"},Qe=["src"],Re={key:1,class:"flex grid-cols-3"},We=["src"],Xe={key:0,class:"flex align-center justify-center h-screen"},Ye="sponsor/default.png",Ge={__name:"SponsorsView",setup(C){const L="https://chgsdev.shareity.com/",_=i([]),X=se(),p=i(),f=i(null);i(18),i(0),i(!0),i("");const $=i(Boolean),y=i(!1),k=i(!1),n=i({label:[]}),Y=i([{label:"Active"},{label:"Inactive"},{label:"Unregisterd"},{label:"Unapproved"}]),G=i({0:"Inactive",1:"Active",5:"Unregisterd",3:"Not validated",undefined:"Invalid"}),m=i({}),H=ne(()=>Z()),U=i(""),V=i({}),j=i(null),J=ke();re(async()=>{if(V.value=await R.getMyProfile(),p.value=V.value.rol,console.log(V.value),p.value==="cause"){await R.adminApprove().then(t=>{}).catch(t=>{j.value=t.response.data.message});return}});function Z(){return _.value.filter(t=>t.name.includes(U.value)&&((n==null?void 0:n.value.label.length)===0?!0:n==null?void 0:n.value.label.includes(M(t))))}function M(t){return t.status==5&&console.log("SI hay pajo pero teienen admin approve = "+t.adminApprove),t.adminApprove?G.value[t.status]||t.status:"Unapproved"}function O(t){if(t=="Deselect All")n.value.label=[],f.value=null;else if(n.value.label.includes(t)){const l=n.value.label.indexOf(t);n.value.label.splice(l,1),f.value=n.value.label.slice(0,1).toString(),console.log(f.value),n.value.label.length||(f.value=null,console.log("hoa"))}else n.value.label.push(t)}function T(t){X.push({name:"create-sponsor",query:{id:t}})}function ee(){J.createAlert({title:"It has not yet been approved",color:"error",icon:"$warning",text:j.value})}async function te(){const t=m.value.id,l=await W.update(t,{status:!m.value.status});console.log(l);const A=_.value.indexOf(m.value);_.value[A].status=l.status,y.value=!1}async function le(){console.log(m.value.id);const t=await ge.updateSponsor({id:m.value.id,adminApprove:1}),l=_.value.indexOf(m.value);_.value[l].adminApprove=t.adminApprove,k.value=!1}const oe=async()=>{try{await W.getAllDashboard().then(t=>{_.value=t,$.value=!1})}catch(t){console.log("error :>> ",t)}};return ie(()=>{oe()}),(t,l)=>{const A=g("v-card-title"),E=g("v-card-text"),q=g("v-spacer"),D=g("v-btn"),z=g("v-card-actions"),P=g("v-card"),F=g("v-dialog"),ae=g("CardBoxComponentTitle");return o(),d(fe,null,{default:a(()=>[s(me,null,{default:a(()=>[s(F,{modelValue:y.value,"onUpdate:modelValue":l[2]||(l[2]=e=>y.value=e),width:"auto"},{default:a(()=>[s(P,null,{default:a(()=>[m.value.status?(o(),d(A,{key:0,class:"text-h5"},{default:a(()=>[u(" Activate Sponsor? ")]),_:1})):(o(),d(A,{key:1,class:"text-h5"},{default:a(()=>[u(" Deactivate Sponsor? ")]),_:1})),m.value.status?(o(),d(E,{key:2},{default:a(()=>[u("Are you sure you want to "),Se,u(" this sponsor?")]),_:1})):(o(),d(E,{key:3},{default:a(()=>[u("Are you sure you want to "),we,u(" this sponsor?")]),_:1})),s(z,null,{default:a(()=>[s(q),s(D,{color:"red",variant:"text",onClick:l[0]||(l[0]=e=>y.value=!1)},{default:a(()=>[u(" Disagree ")]),_:1}),s(D,{color:"green-darken-1",variant:"text",onClick:l[1]||(l[1]=e=>te())},{default:a(()=>[u(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(F,{modelValue:k.value,"onUpdate:modelValue":l[5]||(l[5]=e=>k.value=e),width:"auto"},{default:a(()=>[s(P,null,{default:a(()=>[s(A,{class:"text-h5"},{default:a(()=>[u(" Approve Sponsor? ")]),_:1}),s(E,null,{default:a(()=>[u("Are you sure you want to "),Ce,u(" this sponsor?")]),_:1}),s(z,null,{default:a(()=>[s(q),s(D,{color:"red",variant:"text",onClick:l[3]||(l[3]=e=>k.value=!1)},{default:a(()=>[u(" Disagree ")]),_:1}),s(D,{color:"green-darken-1",variant:"text",onClick:l[4]||(l[4]=e=>le())},{default:a(()=>[u(" Agree ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r("div",$e,[r("div",Ve,[s(h,{to:"/dashboard",icon:S(pe),color:"info","rounded-full":"",small:""},null,8,["icon"]),De,V.value.rol==="admin"?(o(),c("div",Ie,[I(r("select",{id:"",class:"shadow-lg rounded-lg","onUpdate:modelValue":l[6]||(l[6]=e=>f.value=e),onChange:l[7]||(l[7]=e=>O(f.value))},[f.value?v("",!0):(o(),c("option",{key:0,value:null}," Select Status ",8,Ue)),(o(!0),c(B,null,K(Y.value,e=>{var x;return o(),c("option",{class:ue((x=n.value)!=null&&x.label.includes(e.label)?"bg-gray-200/90":"")},w(e.label),3)}),256))],544),[[ce,f.value]]),n.value.label.length>0?(o(),c("div",je,[r("input",{class:"hidden shadow-lg p-2 rounded cursor-pointer hover: border border-sky-700",type:"checkbox",name:"check",id:"check",onChange:l[8]||(l[8]=e=>O("Deselect All"))},null,32),Ee,r("span",null,w(n.value.label.slice(0,2).join(" ").toString()),1),n.value.label.length>2?(o(),c("span",Be," (+"+w(n.value.label.length-2)+" others) ",1)):v("",!0)])):v("",!0)])):v("",!0)]),r("div",Ne,[s(he,null,{default:a(()=>[s(xe,{modelValue:U.value,"onUpdate:modelValue":l[9]||(l[9]=e=>U.value=e),icon:t.mdiAccountBox,value:"Search"},null,8,["modelValue","icon"])]),_:1}),j.value?I((o(),d(h,{key:0,class:"mr-5",label:"Add Sponsor",color:"info",onClick:ee,icon:S(Q)},null,8,["icon"])),[[N,p.value==="cause"||p.value==="admin"]]):I((o(),d(h,{key:1,class:"mr-5",label:"Add Sponsor",color:"info",icon:S(Q),to:"/create-sponsor"},null,8,["icon"])),[[N,p.value==="cause"||p.value==="admin"]])])]),!$.value&&_.value.length==0?(o(),c("div",Le,[s(ye,{label:"It seems that there are no sponsor related to you yet :(",content:'You can create a sponsor by clicking on the "+ Add sponsor" button!'})])):v("",!0),!$.value&&_.value.length>0?(o(),c("div",Me,[(o(!0),c(B,null,K(H.value,e=>(o(),d(_e,{key:e.id},{default:a(()=>[s(ae,{title:"With title & icon"},{default:a(()=>[r("div",Oe,[r("p",Te,w(e.name),1),r("div",qe,[ze,r("p",{class:"text-xs text-gray-500",textContent:w(M(e))},null,8,Pe),e.personEmail?v("",!0):(o(),c("p",Fe," Email not registered "))])])]),_:2},1024),e.logo?(o(),c("div",Ke,[r("img",{class:"col-span-1 mr-3 object-cover rounded-md",src:S(L)+e.logo,style:{height:"64px",width:"64px"}},null,8,Qe)])):(o(),c("div",Re,[r("img",{class:"col-span-1 mr-3",src:S(L)+Ye,style:{height:"64px",width:"64px"}},null,8,We)])),p.value==="admin"?(o(),c(B,{key:2},[e.adminApprove==1?(o(),d(h,{key:0,class:"mt-3 text-lg font-bold italic mr-2",small:"",label:e.status?"Deactivate":"Activate",color:e.status?"danger":"success",onClick:x=>{y.value=!0,m.value=e}},null,8,["label","color","onClick"])):I((o(),d(h,{key:1,disabled:!e.personEmail,class:"mt-3 text-lg font-bold italic mr-2",small:"",label:"Approve",color:"info",onClick:x=>{k.value=!0,m.value=e}},null,8,["disabled","onClick"])),[[N,p.value==="admin"]])],64)):v("",!0),p.value==="admin"?(o(),d(h,{key:3,class:"mt-3 text-lg font-bold italic",small:"",label:"Edit",color:"info",onClick:x=>T(e.id)},null,8,["onClick"])):v("",!0),p.value==="sponsor"&&e.status!=1?(o(),d(h,{key:4,class:"mt-3 text-lg font-bold italic",small:"",label:"Edit",color:"info",onClick:x=>T(e.id)},null,8,["onClick"])):v("",!0)]),_:2},1024))),128))])):v("",!0)]),_:1}),$.value?(o(),c("div",Xe,[s(be)])):v("",!0)]),_:1})}}},ft=Ae(Ge,[["__scopeId","data-v-c1f4339d"]]);export{ft as default};
