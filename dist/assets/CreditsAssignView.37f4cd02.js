import{a as n,j as W,M as u,o as s,c as M,w as d,b as r,g as e,e as X,q as O,z as Y,f as a,F as b,A as Z,K as w,B as ee,t as k,h as R}from"./index.8eef5a34.js";import{S as D,M as te}from"./ServerCall.bf212017.js";import{L as se}from"./LoadingSpinner.708020bb.js";import{_ as oe}from"./NavBar.1d7fa6fb.js";import{_ as ae}from"./LayoutAuthenticated.ccaeb884.js";import{_ as C}from"./BaseButton.060f3a5f.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./alerts.ef7819ba.js";import"./session.f47d2680.js";import"./BaseIcon.86eb869a.js";import"./LoginController.5d91ed5e.js";const A={getSponsorAgencyOrganizationInformation:async _=>{console.log("input :>>",_);try{const l=await D.get(`/user/Sponsors/Organization/Agencies/Information/${_}`);return console.log("Desde el controlador",l.data),l.data}catch(l){console.log(l)}},assignCredits:async _=>{try{return console.log("si llega?",_),(await D.put("/user/assing/credits/to/user",_)).data}catch(l){console.log(l)}}};const le={class:"flex justify-between pb-5"},ne={class:"flex gap-2 items-center"},re=e("p",{class:"font-extrabold"},"Assign Credits",-1),ce={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},ie={class:"flex flex-col float-start gap-3 p-5"},de=e("label",{class:"font-medium"},"Select an User Rol",-1),ue=e("option",{value:"",selected:"",disabled:"",hidden:""},"Select Rol",-1),_e=e("option",{value:"agency"},"Agency",-1),ve=e("option",{value:"organization"},"Organization",-1),pe=e("option",{value:"sponsor"},"Sponsor",-1),me=[ue,_e,ve,pe],ge={class:"relative shadow-md sm:rounded-lg"},fe={class:"table-auto w-full text-sm text-left text-gray-500 dark:text-gray-400"},xe=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"w-60 px-6 py-3"},[e("div",null," Organization Name ")]),e("th",{scope:"col",class:"w-80 px-6 py-3"},"Credits"),e("th",{scope:"col",class:"w-20 px-6 py-3"},[e("span",{class:"text-center"}," Actions ")])])],-1),ye={key:0,class:"w-full flex top-[400px] flex-col gap-3 absolute h-full justify-center text-xl font-medium items-center"},he={class:"h-24 w-24 loading-edit"},be=e("p",{class:"text-[#6b6b6b] font-semibold"},"Loading...",-1),we={key:0,class:"w-full h-full top-[400px] flex absolute justify-center text-xl font-medium items-center"},ke=e("div",null,"No data to show",-1),Ce=[ke],Ae={key:1},Ve={key:0,class:"px-6 py-4 text-[#2b2b2b] font-semibold"},Se={key:1,class:"px-6 py-4 text-[#2b2b2b] font-semibold"},ze={key:2,class:"px-6 py-4 text-[#2b2b2b] font-semibold"},Be={key:3,class:"px-6 py-4 text-[#6b6b6b] font-semibold"},je={class:"text-center"},Ne={class:"flex flex-column items-center justify-center flex-wrap gap-3 p-5"},Ue={key:0},Me={key:0,class:"flex flex-col items-start"},Oe={class:"flex items-center justify-beetwen gap-2"},Re=e("label",null,"Amount",-1),De={key:0,class:"text-[#f00] mt-3 w-full text-end font-semibold text-xs"},Le={key:1},$e=e("p",{class:"text-[#81d125a9] mt-3 w-full text-end font-semibold text-xs"}," Credits Assigned ",-1),Ie=[$e],Xe={__name:"CreditsAssignView",setup(_){const l=n([]),x=n(""),c=n(!1),g=n(),p=n(!1),v=n(null),y=n(""),m=n(!1),V=n(!1),f=n(10),S=n(0),h=n(1);n({field:"name",order:1});const L=W(()=>{const o=(h.value-1)*f.value;return l.value.slice(o,o+f.value)}),$=async o=>{if(o.target.value,o.target.value){c.value=!0;try{l.value=await A.getSponsorAgencyOrganizationInformation(o.target.value),S.value=Math.ceil(l.value.length/f.value)}catch{c.value=!1}finally{c.value=!1}}},I=async o=>{console.log("ROL",o),c.value=!0,v.value=null;try{l.value=await A.getSponsorAgencyOrganizationInformation(o)}catch{c.value=!1}finally{c.value=!1}},z=o=>{g.value=o,p.value=!0,o.user||(m.value=!0)},E=()=>{p.value=!1,setTimeout(()=>{m.value=!1,g.value=null,v.value=null},500)},P=async()=>{if(console.log("res user",g.value),!v.value){y.value="REQUIRED";return}c.value=!0;try{await A.assignCredits({id:g.value.user.id,credits:v.value})&&(p.value=!1,V=!0)}catch(o){console.log(o),c.value=!1}finally{c.value=!1,I(x.value)}};return(o,i)=>{const T=u("BaseButtons"),F=u("v-pagination"),q=u("v-card-title"),H=u("v-spacer"),B=u("v-btn"),K=u("v-card-actions"),Q=u("v-card"),G=u("v-dialog");return s(),M(ae,null,{default:d(()=>[r(oe,null,{default:d(()=>{var j;return[e("div",le,[e("div",ne,[r(C,{to:"/dashboard",icon:X(te),color:"info","rounded-full":"",small:""},null,8,["icon"]),re])]),e("div",ce,[e("div",ie,[de,O(e("select",{sleclass:"border border-[#aaaaaa] shadow-md rounded-lg",onChange:$,"onUpdate:modelValue":i[0]||(i[0]=t=>x.value=t)},me,544),[[Y,x.value]])])]),e("div",ge,[e("table",fe,[xe,c.value?(s(),a("div",ye,[e("div",he,[r(se,{class:"!w-auto !h-auto"})]),be])):(s(),a(b,{key:1},[((j=l.value)==null?void 0:j.length)==0?(s(),a("div",we,Ce)):(s(),a("tbody",Ae,[(s(!0),a(b,null,Z(L.value,t=>{var N,U;return s(),a("tr",{key:t.id,class:"border-b border-[#858585] dark:border-gray-700"},[t.name?(s(),a("td",Ve,k(t.name),1)):(s(),a("td",Se," Not Name ")),(N=t==null?void 0:t.user)!=null&&N.credits?(s(),a("td",ze,k((U=t==null?void 0:t.user)==null?void 0:U.credits),1)):(s(),a("td",Be,"0")),e("td",null,[r(T,{type:"justify-start lg:justify-end","no-wrap":""},{default:d(()=>[r(C,{onClick:J=>z(t),color:"info",label:"Add Credits",class:"mb-2"},null,8,["onClick"]),r(C,{onClick:J=>z(t),color:"info",label:"History"},null,8,["onClick"])]),_:2},1024)])])}),128))]))],64))]),e("div",je,[r(F,{modelValue:h.value,"onUpdate:modelValue":i[1]||(i[1]=t=>h.value=t),length:S.value,"total-visible":f.value},null,8,["modelValue","length","total-visible"])])]),r(G,{modelValue:p.value,"onUpdate:modelValue":i[3]||(i[3]=t=>p.value=t),width:"auto"},{default:d(()=>[r(Q,null,{default:d(()=>[r(q,{class:"text-4xl font-bold pt-5"},{default:d(()=>[w(" Assign Credits to User ")]),_:1}),e("div",Ne,[m.value?(s(),a("div",Ue,"there is no user related to this organization")):(s(),a(b,{key:1},[m.value?(s(),a("div",Le,Ie)):(s(),a("div",Me,[e("div",Oe,[Re,O(e("input",{class:"!border-[2px] border-[#111111] rounded-lg shadow-md text-sm","onUpdate:modelValue":i[2]||(i[2]=t=>v.value=t),type:"text"},null,512),[[ee,v.value]])]),y.value?(s(),a("p",De,k(y.value),1)):R("",!0)]))],64)),r(K,null,{default:d(()=>[r(H),r(B,{class:"mr-2",color:"red-darken-1",variant:"text",onClick:E},{default:d(()=>[w(" Close ")]),_:1}),!m.value||V.value?(s(),M(B,{key:0,onClick:P,class:"mr-2",color:"green-darken-1",variant:"text"},{default:d(()=>[w(" Accept ")]),_:1})):R("",!0)]),_:1})])]),_:1})]),_:1},8,["modelValue"])]}),_:1})]),_:1})}}};export{Xe as default};
